# NATS Server configuration for JetStream testing

# Basic server settings
port: 4222
server_name: nats-jetstream

# WebSocket support for browser testing
websocket {
    port: 8080
    no_tls: true
}

# Enable JetStream
jetstream {
    # Store directory for JetStream data
    store_dir: "/tmp/nats/jetstream"
    
    # Maximum memory usage (256MB)
    max_memory_store: 268435456
    
    # Maximum file storage (1GB)
    max_file_store: 1073741824
    
    # Domain name for this JetStream instance
    domain: "test"
}

# Logging settings
debug: true
trace: true
logtime: true

# Authorization for JetStream tests. Keep existing unauthenticated behavior by
# specifying a no_auth_user with full permissions. Add a restricted user to
# exercise permission failures in tests.
authorization: {
    users: [
        { user: "js_full", pass: "full", permissions: { publish: { allow: [">"] }, subscribe: { allow: [">"] } } },
        { user: "js_restricted", pass: "restricted", permissions: { 
            publish: { allow: ["$JS.API.>", "events.allowed.>"], deny: ["events.denied.>"] }, 
            subscribe: { allow: ["$JS.API.>", "events.allowed.>", "_INBOX.>"], deny: ["events.denied.>"] }
        } }
    ]
}

no_auth_user: js_full